# Sparkify's Data Lake

The goal of this project is to create a datalake to collect songs and user activity on Sparkify streaming app. The ETL can import files from a S3 buckets of JSON logs on user activity and metadata of the songs in the Sparkify, using spark (pyspark).
It creates the tables in another S3 bucket in parquet format

# Files


**README.md**: This File

**dwh.cfg**: Config File

**etl.py**: ETL pipeline to load the data into the Postgres Database


# Song Dataset
The first dataset is a subset of real data from the Million Song Dataset. Each file is in JSON format and contains metadata about a song and the artist of that song. The files are partitioned by the first three letters of each song's track ID. For example, here are filepaths to two files in this dataset.

	song_data/A/B/C/TRABCEI128F424C983.json
	song_data/A/A/B/TRAABJL12903CDCF1A.jso
 
And below is an example of what a single song file, TRAABJL12903CDCF1A.json, looks like.

	{"num_songs": 1, "artist_id": "ARJIE2Y1187B994AB7", "artist_latitude": null, "artist_longitude": null, "artist_location": "", "artist_name": "Line Renaud", "song_id": "SOUPIRU12A6D4FA1E1", "title": "Der Kleine Dompfaff", "duration": 152.92036, "year": 0}

# Log Dataset
The second dataset consists of log files in JSON format generated by this event simulator based on the songs in the dataset above. These simulate app activity logs from an imaginary music streaming app based on configuration settings.

The log files in the dataset you'll be working with are partitioned by year and month. For example, here are filepaths to two files in this dataset.

  log_data/2018/11/2018-11-12-events.json
  log_data/2018/11/2018-11-13-events.json

And below is an example of what the data in a log file, 2018-11-12-events.json, looks like.
![](images/log-data.png)

# How to Run

Load the tables from the S3 Bucket and create the Parquet tables by running
#python etl.py

You are read to go.

# Database Description

### songplays table
It contains records in log data associated with song plays.
Songplays table files are partitioned by year and month.

**songplays structure:**

![songplays structure](images/songplay_struct.GIF)

### users table
It contains user records in the app (First and Last name) and the type of subscription they have (free or paid).

**users structure:**

![songplays structure](images/users_struct.GIF)

**users sample:**

![songplays sample](images/users_sample.GIF)

### songs table
Comprehensive list of songs in music database.
Songs table files are partitioned by year and then artist.

**songs structure:**

![songs structure](images/songs_struct.GIF)

**songs sample:**

![songs sample](images/songs_sample.GIF)

### artists table
Comprehensive list of artists in music database, including location.

**artists structure:**

![artists structure](images/artists_struct.GIF)

**artists sample:**

![artists sample](images/artists_sample.GIF)


### time table
Timestamps of records in songplays broken down into specific units.
Time table files are partitioned by year and month

**time structure:**

![time structure](images/time_struct.GIF)

**time sample:**

![time sample](images/time_sample.GIF)
